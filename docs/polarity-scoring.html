<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>3.2 Polarity Scoring | Natural Language Processing in R</title>
  <meta name="description" content="Background and tutorial on natural language processing in R (topic modeling, sentiment analysis) using R." />
  <meta name="generator" content="bookdown 0.36 and GitBook 2.6.7" />

  <meta property="og:title" content="3.2 Polarity Scoring | Natural Language Processing in R" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Background and tutorial on natural language processing in R (topic modeling, sentiment analysis) using R." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="3.2 Polarity Scoring | Natural Language Processing in R" />
  
  <meta name="twitter:description" content="Background and tutorial on natural language processing in R (topic modeling, sentiment analysis) using R." />
  

<meta name="author" content="Michael Foley" />


<meta name="date" content="2023-11-21" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="subjectivity-lexicons.html"/>
<link rel="next" href="statistical-test.html"/>
<script src="assets/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="assets/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="assets/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="assets/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="assets/anchor-sections-1.1.0/anchor-sections.js"></script>
<link href="assets/tabwid-1.1.3/tabwid.css" rel="stylesheet" />
<script src="assets/tabwid-1.1.3/tabwid.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Intro</a></li>
<li class="chapter" data-level="1" data-path="data-prep.html"><a href="data-prep.html"><i class="fa fa-check"></i><b>1</b> Data Preparation</a>
<ul>
<li class="chapter" data-level="1.1" data-path="scrub.html"><a href="scrub.html"><i class="fa fa-check"></i><b>1.1</b> Scrub</a></li>
<li class="chapter" data-level="1.2" data-path="tokenize.html"><a href="tokenize.html"><i class="fa fa-check"></i><b>1.2</b> Tokenize</a></li>
<li class="chapter" data-level="1.3" data-path="spell-check.html"><a href="spell-check.html"><i class="fa fa-check"></i><b>1.3</b> Spell-check</a></li>
<li class="chapter" data-level="1.4" data-path="lemmatize.html"><a href="lemmatize.html"><i class="fa fa-check"></i><b>1.4</b> Lemmatize</a></li>
<li class="chapter" data-level="1.5" data-path="remove-stop-words.html"><a href="remove-stop-words.html"><i class="fa fa-check"></i><b>1.5</b> Remove Stop Words</a></li>
<li class="chapter" data-level="1.6" data-path="bigrams.html"><a href="bigrams.html"><i class="fa fa-check"></i><b>1.6</b> Bigrams</a></li>
<li class="chapter" data-level="1.7" data-path="save.html"><a href="save.html"><i class="fa fa-check"></i><b>1.7</b> Save</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="topicmodeling.html"><a href="topicmodeling.html"><i class="fa fa-check"></i><b>2</b> Topic Modeling</a>
<ul>
<li class="chapter" data-level="2.1" data-path="learning-by-example.html"><a href="learning-by-example.html"><i class="fa fa-check"></i><b>2.1</b> Learning by Example</a></li>
<li class="chapter" data-level="2.2" data-path="lda.html"><a href="lda.html"><i class="fa fa-check"></i><b>2.2</b> LDA</a></li>
<li class="chapter" data-level="2.3" data-path="ctm.html"><a href="ctm.html"><i class="fa fa-check"></i><b>2.3</b> CTM</a></li>
<li class="chapter" data-level="2.4" data-path="stm.html"><a href="stm.html"><i class="fa fa-check"></i><b>2.4</b> STM</a>
<ul>
<li class="chapter" data-level="" data-path="stm.html"><a href="stm.html#data-preparation"><i class="fa fa-check"></i>Data Preparation</a></li>
<li class="chapter" data-level="" data-path="stm.html"><a href="stm.html#prepare"><i class="fa fa-check"></i>Prepare</a></li>
<li class="chapter" data-level="" data-path="stm.html"><a href="stm.html#evaluate"><i class="fa fa-check"></i>Evaluate</a></li>
<li class="chapter" data-level="" data-path="stm.html"><a href="stm.html#interpret"><i class="fa fa-check"></i>Interpret</a></li>
<li class="chapter" data-level="" data-path="stm.html"><a href="stm.html#visualize"><i class="fa fa-check"></i>Visualize</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="data-formats.html"><a href="data-formats.html"><i class="fa fa-check"></i><b>2.5</b> Data Formats</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="sentimentanalysis.html"><a href="sentimentanalysis.html"><i class="fa fa-check"></i><b>3</b> Sentiment Analysis</a>
<ul>
<li class="chapter" data-level="3.1" data-path="subjectivity-lexicons.html"><a href="subjectivity-lexicons.html"><i class="fa fa-check"></i><b>3.1</b> Subjectivity Lexicons</a></li>
<li class="chapter" data-level="3.2" data-path="polarity-scoring.html"><a href="polarity-scoring.html"><i class="fa fa-check"></i><b>3.2</b> Polarity Scoring</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="polarity-scoring.html"><a href="polarity-scoring.html#tidytext-1"><i class="fa fa-check"></i><b>3.2.1</b> tidytext</a></li>
<li class="chapter" data-level="3.2.2" data-path="polarity-scoring.html"><a href="polarity-scoring.html#sentimentr"><i class="fa fa-check"></i><b>3.2.2</b> sentimentr</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="statistical-test.html"><a href="statistical-test.html"><i class="fa fa-check"></i><b>3.3</b> Statistical Test</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Natural Language Processing in R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="polarity-scoring" class="section level2 hasAnchor" number="3.2">
<h2><span class="header-section-number">3.2</span> Polarity Scoring<a href="polarity-scoring.html#polarity-scoring" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Two packages measure text polarity. The simpler one <strong>tidytext</strong>: unnest tokens, join to the Bing lexicon, and calculate the net of positive minus negative polarity counts. <strong>sentimentr</strong> is more sophisticated in that it takes into account <em>valence shifters</em>, surrounding words that change the intensity of a sentiment (e.g., “very”) or switch its direction (e.g., “not”).<a href="#fn3" class="footnote-ref" id="fnref3"><sup>3</sup></a></p>
<div id="tidytext-1" class="section level3 hasAnchor" number="3.2.1">
<h3><span class="header-section-number">3.2.1</span> tidytext<a href="polarity-scoring.html#tidytext-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The <strong>tidytext</strong> way to score polarity is to tag words as “positive” and “negative” using the Bing lexicon, then calculate the difference in counts. The <strong>qdap</strong> and <strong>sentimentr</strong> packages correct for text length by dividing by <span class="math inline">\(\sqrt{n}\)</span>. It is useful to capture the positive and negative words back in the main data frame for explaining how the polarity score was calculated.</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="polarity-scoring.html#cb38-1" tabindex="-1"></a>polarity_bing <span class="ot">&lt;-</span> </span>
<span id="cb38-2"><a href="polarity-scoring.html#cb38-2" tabindex="-1"></a>  token <span class="sc">%&gt;%</span></span>
<span id="cb38-3"><a href="polarity-scoring.html#cb38-3" tabindex="-1"></a>  <span class="fu">left_join</span>(bing, <span class="at">by =</span> <span class="st">&quot;word&quot;</span>, <span class="at">relationship =</span> <span class="st">&quot;many-to-one&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb38-4"><a href="polarity-scoring.html#cb38-4" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">.by =</span> <span class="fu">c</span>(review_id, sentiment), <span class="at">n =</span> <span class="fu">n</span>(), <span class="at">words =</span> <span class="fu">list</span>(word)) <span class="sc">%&gt;%</span></span>
<span id="cb38-5"><a href="polarity-scoring.html#cb38-5" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> sentiment, <span class="at">values_from =</span> <span class="fu">c</span>(n, words), </span>
<span id="cb38-6"><a href="polarity-scoring.html#cb38-6" tabindex="-1"></a>              <span class="at">values_fill =</span> <span class="fu">list</span>(<span class="at">n =</span> <span class="dv">0</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb38-7"><a href="polarity-scoring.html#cb38-7" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(n_NA, words_NA)) <span class="sc">%&gt;%</span></span>
<span id="cb38-8"><a href="polarity-scoring.html#cb38-8" tabindex="-1"></a>  <span class="fu">inner_join</span>(hotel_0 <span class="sc">%&gt;%</span> <span class="fu">select</span>(review_id, word_cnt), <span class="at">by =</span> <span class="st">&quot;review_id&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb38-9"><a href="polarity-scoring.html#cb38-9" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb38-10"><a href="polarity-scoring.html#cb38-10" tabindex="-1"></a>    <span class="at">polarity =</span> (n_positive <span class="sc">-</span> n_negative) <span class="sc">/</span> <span class="fu">sqrt</span>(word_cnt),</span>
<span id="cb38-11"><a href="polarity-scoring.html#cb38-11" tabindex="-1"></a>    <span class="at">polarity_desc =</span> <span class="fu">if_else</span>(polarity <span class="sc">&gt;=</span> <span class="dv">0</span>, <span class="st">&quot;Positive&quot;</span>, <span class="st">&quot;Negative&quot;</span>)</span>
<span id="cb38-12"><a href="polarity-scoring.html#cb38-12" tabindex="-1"></a>  )</span>
<span id="cb38-13"><a href="polarity-scoring.html#cb38-13" tabindex="-1"></a></span>
<span id="cb38-14"><a href="polarity-scoring.html#cb38-14" tabindex="-1"></a>polarity_bing <span class="sc">%&gt;%</span> <span class="fu">filter</span>(review_id <span class="sc">==</span> <span class="dv">520</span>)</span></code></pre></div>
<pre><code>## # A tibble: 1 × 8
##   review_id n_positive n_negative words_positive words_negative word_cnt
##       &lt;int&gt;      &lt;int&gt;      &lt;int&gt; &lt;list&gt;         &lt;list&gt;            &lt;int&gt;
## 1       520          0          0 &lt;NULL&gt;         &lt;NULL&gt;               47
## # ℹ 2 more variables: polarity &lt;dbl&gt;, polarity_desc &lt;chr&gt;</code></pre>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="polarity-scoring.html#cb40-1" tabindex="-1"></a>polarity_afinn <span class="ot">&lt;-</span> </span>
<span id="cb40-2"><a href="polarity-scoring.html#cb40-2" tabindex="-1"></a>  token <span class="sc">%&gt;%</span></span>
<span id="cb40-3"><a href="polarity-scoring.html#cb40-3" tabindex="-1"></a>  <span class="fu">inner_join</span>(afinn, <span class="at">by =</span> <span class="st">&quot;word&quot;</span>, <span class="at">relationship =</span> <span class="st">&quot;many-to-one&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb40-4"><a href="polarity-scoring.html#cb40-4" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">.by =</span> review_id, <span class="at">sentiment =</span> <span class="fu">sum</span>(value), <span class="at">words =</span> <span class="fu">list</span>(word)) <span class="sc">%&gt;%</span></span>
<span id="cb40-5"><a href="polarity-scoring.html#cb40-5" tabindex="-1"></a>  <span class="fu">inner_join</span>(hotel_0 <span class="sc">%&gt;%</span> <span class="fu">select</span>(review_id, word_cnt), <span class="at">by =</span> <span class="st">&quot;review_id&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb40-6"><a href="polarity-scoring.html#cb40-6" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb40-7"><a href="polarity-scoring.html#cb40-7" tabindex="-1"></a>    <span class="at">polarity =</span> sentiment <span class="sc">/</span> <span class="fu">sqrt</span>(word_cnt),</span>
<span id="cb40-8"><a href="polarity-scoring.html#cb40-8" tabindex="-1"></a>    <span class="at">polarity_desc =</span> <span class="fu">if_else</span>(polarity <span class="sc">&gt;=</span> <span class="dv">0</span>, <span class="st">&quot;Positive&quot;</span>, <span class="st">&quot;Negative&quot;</span>)</span>
<span id="cb40-9"><a href="polarity-scoring.html#cb40-9" tabindex="-1"></a>  )</span>
<span id="cb40-10"><a href="polarity-scoring.html#cb40-10" tabindex="-1"></a></span>
<span id="cb40-11"><a href="polarity-scoring.html#cb40-11" tabindex="-1"></a><span class="co"># Attach to main data frame</span></span>
<span id="cb40-12"><a href="polarity-scoring.html#cb40-12" tabindex="-1"></a>hotel_1 <span class="ot">&lt;-</span></span>
<span id="cb40-13"><a href="polarity-scoring.html#cb40-13" tabindex="-1"></a>  hotel_0 <span class="sc">%&gt;%</span></span>
<span id="cb40-14"><a href="polarity-scoring.html#cb40-14" tabindex="-1"></a>  <span class="fu">left_join</span>(polarity_bing <span class="sc">%&gt;%</span> </span>
<span id="cb40-15"><a href="polarity-scoring.html#cb40-15" tabindex="-1"></a>              <span class="fu">select</span>(review_id, polarity, words_positive, words_negative) <span class="sc">%&gt;%</span></span>
<span id="cb40-16"><a href="polarity-scoring.html#cb40-16" tabindex="-1"></a>              <span class="fu">rename_with</span>(<span class="sc">~</span><span class="fu">paste0</span>(<span class="st">&quot;bing_&quot;</span>, .x)),</span>
<span id="cb40-17"><a href="polarity-scoring.html#cb40-17" tabindex="-1"></a>            <span class="at">by =</span> <span class="fu">join_by</span>(review_id <span class="sc">==</span> bing_review_id)) <span class="sc">%&gt;%</span></span>
<span id="cb40-18"><a href="polarity-scoring.html#cb40-18" tabindex="-1"></a>  <span class="fu">left_join</span>(polarity_afinn <span class="sc">%&gt;%</span> </span>
<span id="cb40-19"><a href="polarity-scoring.html#cb40-19" tabindex="-1"></a>              <span class="fu">select</span>(review_id, polarity) <span class="sc">%&gt;%</span></span>
<span id="cb40-20"><a href="polarity-scoring.html#cb40-20" tabindex="-1"></a>              <span class="fu">rename_with</span>(<span class="sc">~</span><span class="fu">paste0</span>(<span class="st">&quot;afinn_&quot;</span>, .x)),</span>
<span id="cb40-21"><a href="polarity-scoring.html#cb40-21" tabindex="-1"></a>            <span class="at">by =</span> <span class="fu">join_by</span>(review_id <span class="sc">==</span> afinn_review_id))</span></code></pre></div>
<p>Let’s see how the polarity scores compare.</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="polarity-scoring.html#cb41-1" tabindex="-1"></a>hotel_1 <span class="sc">%&gt;%</span></span>
<span id="cb41-2"><a href="polarity-scoring.html#cb41-2" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(bing_polarity, afinn_polarity), </span>
<span id="cb41-3"><a href="polarity-scoring.html#cb41-3" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">&quot;lexicon&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;polarity&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb41-4"><a href="polarity-scoring.html#cb41-4" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(polarity)) <span class="sc">%&gt;%</span></span>
<span id="cb41-5"><a href="polarity-scoring.html#cb41-5" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> polarity, <span class="at">y =</span> <span class="fu">fct_rev</span>(property))) <span class="sc">+</span></span>
<span id="cb41-6"><a href="polarity-scoring.html#cb41-6" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb41-7"><a href="polarity-scoring.html#cb41-7" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="at">facets =</span> <span class="fu">vars</span>(lexicon)) <span class="sc">+</span></span>
<span id="cb41-8"><a href="polarity-scoring.html#cb41-8" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Review polarity&quot;</span>, <span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">y =</span> <span class="cn">NULL</span>,</span>
<span id="cb41-9"><a href="polarity-scoring.html#cb41-9" tabindex="-1"></a>       <span class="at">caption =</span> glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">&quot;Bing Polarity = (n_pos - n_neg) / sqrt(n_words)</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb41-10"><a href="polarity-scoring.html#cb41-10" tabindex="-1"></a>                      <span class="st">&quot;AFINN Polarity = sentiment / sqrt(n_words)&quot;</span>))</span></code></pre></div>
<p><img src="nlp_files/figure-html/unnamed-chunk-26-1.png" width="672" /></p>
<p>The two lexicons are similar. The data set includes a numeric rating <code>review_rating</code> (1-5). I’ll stick with Bing going forward for convenience. The polarity score should correlate with the numeric rating.</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="polarity-scoring.html#cb42-1" tabindex="-1"></a>hotel_1 <span class="sc">%&gt;%</span> </span>
<span id="cb42-2"><a href="polarity-scoring.html#cb42-2" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(bing_polarity)) <span class="sc">%&gt;%</span></span>
<span id="cb42-3"><a href="polarity-scoring.html#cb42-3" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">as_factor</span>(rating), <span class="at">y =</span> bing_polarity)) <span class="sc">+</span></span>
<span id="cb42-4"><a href="polarity-scoring.html#cb42-4" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>, <span class="at">color =</span> <span class="st">&quot;#5DA5DA&quot;</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb42-5"><a href="polarity-scoring.html#cb42-5" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">alpha =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb42-6"><a href="polarity-scoring.html#cb42-6" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb42-7"><a href="polarity-scoring.html#cb42-7" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Polarity is associated with overall Likert score&quot;</span>,</span>
<span id="cb42-8"><a href="polarity-scoring.html#cb42-8" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Overall Likert Rating&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Polarity Score&quot;</span>)</span></code></pre></div>
<p><img src="nlp_files/figure-html/unnamed-chunk-27-1.png" width="672" /></p>
<p>Sentiment increases with Likert rating, but there are many reviews with a rating of 5 and a polarity score &lt;0. In some cases this is because the reviewer interpreted the scale incorrectly. You can use polarity scores to identify problematic reviews like these.</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="polarity-scoring.html#cb43-1" tabindex="-1"></a>hotel_1 <span class="sc">%&gt;%</span></span>
<span id="cb43-2"><a href="polarity-scoring.html#cb43-2" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb43-3"><a href="polarity-scoring.html#cb43-3" tabindex="-1"></a>    <span class="at">problematic =</span> <span class="fu">case_when</span>(</span>
<span id="cb43-4"><a href="polarity-scoring.html#cb43-4" tabindex="-1"></a>      (rating <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> bing_polarity <span class="sc">&gt;</span> <span class="fl">0.5</span>) <span class="sc">~</span> <span class="st">&quot;Too Low&quot;</span>,</span>
<span id="cb43-5"><a href="polarity-scoring.html#cb43-5" tabindex="-1"></a>      (rating <span class="sc">==</span> <span class="dv">5</span> <span class="sc">&amp;</span> bing_polarity <span class="sc">&lt;</span> <span class="sc">-</span>.<span class="dv">5</span>) <span class="sc">~</span> <span class="st">&quot;Too High&quot;</span>,</span>
<span id="cb43-6"><a href="polarity-scoring.html#cb43-6" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">&quot;Other&quot;</span></span>
<span id="cb43-7"><a href="polarity-scoring.html#cb43-7" tabindex="-1"></a>    )</span>
<span id="cb43-8"><a href="polarity-scoring.html#cb43-8" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb43-9"><a href="polarity-scoring.html#cb43-9" tabindex="-1"></a>  <span class="fu">filter</span>(problematic <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;Too High&quot;</span>, <span class="st">&quot;Too Low&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb43-10"><a href="polarity-scoring.html#cb43-10" tabindex="-1"></a>  <span class="fu">group_by</span>(problematic) <span class="sc">%&gt;%</span></span>
<span id="cb43-11"><a href="polarity-scoring.html#cb43-11" tabindex="-1"></a>  <span class="fu">slice_max</span>(<span class="at">order_by =</span> <span class="fu">abs</span>(bing_polarity), <span class="at">n =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb43-12"><a href="polarity-scoring.html#cb43-12" tabindex="-1"></a>  <span class="fu">select</span>(problematic, rating, bing_polarity, review) <span class="sc">%&gt;%</span></span>
<span id="cb43-13"><a href="polarity-scoring.html#cb43-13" tabindex="-1"></a>  flextable<span class="sc">::</span><span class="fu">flextable</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb43-14"><a href="polarity-scoring.html#cb43-14" tabindex="-1"></a>  flextable<span class="sc">::</span><span class="fu">autofit</span>() <span class="sc">%&gt;%</span></span>
<span id="cb43-15"><a href="polarity-scoring.html#cb43-15" tabindex="-1"></a>  flextable<span class="sc">::</span><span class="fu">valign</span>(<span class="at">valign =</span> <span class="st">&quot;top&quot;</span>)</span></code></pre></div>
<div class="tabwid tabwid_left"><style>.cl-74aa8118{}.cl-74a481aa{font-family:'Arial';font-size:10pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-74a481b4{font-family:'Arial';font-size:10pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-74a6e7a6{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-74a6e7b0{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-74a6e7ba{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-74a6e7c4{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-74a6f82c{width:1.072in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-74a6f836{width:0.671in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-74a6f837{width:1.157in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-74a6f840{width:32.807in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-74a6f841{width:1.072in;background-color:transparent;vertical-align: top;border-bottom: 0.75pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-74a6f84a{width:0.671in;background-color:transparent;vertical-align: top;border-bottom: 0.75pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-74a6f84b{width:1.157in;background-color:transparent;vertical-align: top;border-bottom: 0.75pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-74a6f854{width:32.807in;background-color:transparent;vertical-align: top;border-bottom: 0.75pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-74a6f855{width:1.072in;background-color:transparent;vertical-align: top;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0.75pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-74a6f85e{width:0.671in;background-color:transparent;vertical-align: top;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0.75pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-74a6f85f{width:1.157in;background-color:transparent;vertical-align: top;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0.75pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-74a6f868{width:32.807in;background-color:transparent;vertical-align: top;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0.75pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing='true' class='cl-74aa8118'><thead><tr style="overflow-wrap:break-word;"><th class="cl-74a6f82c"><p class="cl-74a6e7a6"><span class="cl-74a481aa">problematic</span></p></th><th class="cl-74a6f836"><p class="cl-74a6e7b0"><span class="cl-74a481aa">rating</span></p></th><th class="cl-74a6f837"><p class="cl-74a6e7b0"><span class="cl-74a481aa">bing_polarity</span></p></th><th class="cl-74a6f840"><p class="cl-74a6e7a6"><span class="cl-74a481aa">review</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-74a6f841"><p class="cl-74a6e7ba"><span class="cl-74a481b4">Too High</span></p></td><td class="cl-74a6f84a"><p class="cl-74a6e7c4"><span class="cl-74a481b4">5</span></p></td><td class="cl-74a6f84b"><p class="cl-74a6e7c4"><span class="cl-74a481b4">-0.9801961</span></p></td><td class="cl-74a6f854"><p class="cl-74a6e7ba"><span class="cl-74a481b4">Some design faults in the bathroom - no stool, misplaced grab handles and vanity mirror. Very disappointing experience in Savoy Grill. Good quality ingredients but poorly presented and tasteless. Numerous mistakes in service including charging for expensive drinks which we did not have. Service charge revoked and booking for following night cancelled.</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-74a6f855"><p class="cl-74a6e7ba"><span class="cl-74a481b4">Too Low</span></p></td><td class="cl-74a6f85e"><p class="cl-74a6e7c4"><span class="cl-74a481b4">1</span></p></td><td class="cl-74a6f85f"><p class="cl-74a6e7c4"><span class="cl-74a481b4">0.8728716</span></p></td><td class="cl-74a6f868"><p class="cl-74a6e7ba"><span class="cl-74a481b4">Stayed here many times both for business and pleasure, alone, with my wife and even with extended family and children. It is in fact impossible to seperate the business and pleasure stays because everytime was a breathtakingly delectable pleasure. Meeting friends and colleagues whether in the lobby one of the resturants always left an impressive memorable impression. Alas, I haven't been able to visit again for sometime - either fully booked or are not able to guarantee convenient parking for my personal chauffeur and car.</span></p></td></tr></tbody></table></div>
<p>The polarity words can help explain why some hotels rated poor or excellent.</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="polarity-scoring.html#cb44-1" tabindex="-1"></a>token <span class="sc">%&gt;%</span></span>
<span id="cb44-2"><a href="polarity-scoring.html#cb44-2" tabindex="-1"></a>  <span class="fu">inner_join</span>(hotel_1 <span class="sc">%&gt;%</span> <span class="fu">filter</span>(rating <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">5</span>)), <span class="at">by =</span> <span class="fu">join_by</span>(review_id)) <span class="sc">%&gt;%</span></span>
<span id="cb44-3"><a href="polarity-scoring.html#cb44-3" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>word <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;hotel&quot;</span>, <span class="st">&quot;stay&quot;</span>, <span class="st">&quot;night&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb44-4"><a href="polarity-scoring.html#cb44-4" tabindex="-1"></a>  <span class="fu">filter</span>((rating <span class="sc">==</span> <span class="dv">5</span> <span class="sc">&amp;</span> bing_polarity <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">|</span> </span>
<span id="cb44-5"><a href="polarity-scoring.html#cb44-5" tabindex="-1"></a>         (rating <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> bing_polarity <span class="sc">&lt;</span> <span class="dv">0</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb44-6"><a href="polarity-scoring.html#cb44-6" tabindex="-1"></a>  <span class="fu">count</span>(rating, word) <span class="sc">%&gt;%</span></span>
<span id="cb44-7"><a href="polarity-scoring.html#cb44-7" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">.by =</span> rating, <span class="at">pct =</span> n <span class="sc">/</span> <span class="fu">sum</span>(n)) <span class="sc">%&gt;%</span></span>
<span id="cb44-8"><a href="polarity-scoring.html#cb44-8" tabindex="-1"></a>  <span class="fu">group_by</span>(rating) <span class="sc">%&gt;%</span></span>
<span id="cb44-9"><a href="polarity-scoring.html#cb44-9" tabindex="-1"></a>  <span class="fu">slice_max</span>(<span class="at">order_by =</span> pct, <span class="at">n =</span> <span class="dv">10</span>) <span class="sc">%&gt;%</span></span>
<span id="cb44-10"><a href="polarity-scoring.html#cb44-10" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> pct, <span class="at">y =</span> <span class="fu">reorder_within</span>(word, <span class="at">by =</span> pct, <span class="at">within =</span> rating))) <span class="sc">+</span></span>
<span id="cb44-11"><a href="polarity-scoring.html#cb44-11" tabindex="-1"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb44-12"><a href="polarity-scoring.html#cb44-12" tabindex="-1"></a>  <span class="fu">scale_y_reordered</span>() <span class="sc">+</span></span>
<span id="cb44-13"><a href="polarity-scoring.html#cb44-13" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">labels =</span> <span class="fu">percent_format</span>(<span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb44-14"><a href="polarity-scoring.html#cb44-14" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="cn">NULL</span>, <span class="at">x =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb44-15"><a href="polarity-scoring.html#cb44-15" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="at">facets =</span> <span class="fu">vars</span>(rating), <span class="at">scales =</span> <span class="st">&quot;free_y&quot;</span>)</span></code></pre></div>
<p><img src="nlp_files/figure-html/unnamed-chunk-29-1.png" width="672" /></p>
<p>Word clouds are a nice way to get an overview of the data.</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="polarity-scoring.html#cb45-1" tabindex="-1"></a>token <span class="sc">%&gt;%</span></span>
<span id="cb45-2"><a href="polarity-scoring.html#cb45-2" tabindex="-1"></a>  <span class="fu">inner_join</span>(hotel_1 <span class="sc">%&gt;%</span> <span class="fu">filter</span>(rating <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">5</span>)), <span class="at">by =</span> <span class="fu">join_by</span>(review_id)) <span class="sc">%&gt;%</span></span>
<span id="cb45-3"><a href="polarity-scoring.html#cb45-3" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>word <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;hotel&quot;</span>, <span class="st">&quot;stay&quot;</span>, <span class="st">&quot;night&quot;</span>, <span class="st">&quot;london&quot;</span>),</span>
<span id="cb45-4"><a href="polarity-scoring.html#cb45-4" tabindex="-1"></a>         <span class="sc">!</span><span class="fu">is.na</span>(bing_polarity)) <span class="sc">%&gt;%</span></span>
<span id="cb45-5"><a href="polarity-scoring.html#cb45-5" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">polarity_desc =</span> <span class="fu">if_else</span>(bing_polarity <span class="sc">&gt;</span> <span class="dv">0</span>, <span class="st">&quot;Positive&quot;</span>, <span class="st">&quot;Negative&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb45-6"><a href="polarity-scoring.html#cb45-6" tabindex="-1"></a>  <span class="fu">count</span>(word, polarity_desc, <span class="at">wt =</span> word_cnt) <span class="sc">%&gt;%</span></span>
<span id="cb45-7"><a href="polarity-scoring.html#cb45-7" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> polarity_desc, <span class="at">values_from =</span> n, <span class="at">values_fill =</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb45-8"><a href="polarity-scoring.html#cb45-8" tabindex="-1"></a>  data.table<span class="sc">::</span><span class="fu">data.table</span>() <span class="sc">%&gt;%</span></span>
<span id="cb45-9"><a href="polarity-scoring.html#cb45-9" tabindex="-1"></a>  <span class="fu">as.matrix</span>(<span class="at">rownames =</span> <span class="st">&quot;word&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb45-10"><a href="polarity-scoring.html#cb45-10" tabindex="-1"></a>  wordcloud<span class="sc">::</span><span class="fu">comparison.cloud</span>(<span class="at">max.words =</span> <span class="dv">30</span>, <span class="at">title.size =</span> <span class="fl">1.5</span>, <span class="at">scale =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">3.5</span>))</span></code></pre></div>
<p><img src="nlp_files/figure-html/unnamed-chunk-30-1.png" width="672" /></p>
</div>
<div id="sentimentr" class="section level3 hasAnchor" number="3.2.2">
<h3><span class="header-section-number">3.2.2</span> sentimentr<a href="polarity-scoring.html#sentimentr" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong>sentimentr</strong> calculates polarity at the sentence level. It improves on <strong>tidytext</strong> in that it takes into account the context in which the sentiment words occur by incorporating <em>valence shifters</em>.</p>
<ul>
<li>A <em>negator</em> flips the direction of a polarizing word (e.g., “I do <strong><em>not</em></strong> like it.”). <code>lexicon::hash_valence_shifters[y==1]</code>.</li>
<li>An <em>amplifier</em> intensifies the impact (e.g., “I <strong><em>really</em></strong> like it.”). <code>lexicon::hash_valence_shifters[y==2]</code>.</li>
<li>A <em>de-amplifier</em> (downtoner) reduces the impact (e.g., “I <strong>hardly</strong> like it.”). <code>lexicon::hash_valence_shifters[y==3]</code>.</li>
<li>An <em>adversative conjunction</em> overrules the previous clause containing a polarized word (e.g., “I like it <strong><em>but</em></strong> it’s not worth it.”). <code>lexicon::hash_valence_shifters[y==4]</code>.</li>
</ul>
<p><strong>sentimentr</strong> uses a lexicon package combined from the <strong>syuzhet</strong> and <strong>lexicon</strong> packages. Positive words are scored +1 and negative words are scored -1. <strong>sentimentr</strong> identifies clusters of words within sentences of the text. The 4 words before and 2 words after are candidate valence shifters. Polarized words are weighted by the valence shifter weights: negators = -1; amplifiers and de-amplifiers = 1.8; adversative conjunctions decrease the value of the prior cluster and increase the value of the following cluster. Neutral words hold no value, but do affect the word count.</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="polarity-scoring.html#cb46-1" tabindex="-1"></a>hotel_sentimentr <span class="ot">&lt;-</span> </span>
<span id="cb46-2"><a href="polarity-scoring.html#cb46-2" tabindex="-1"></a>  sentimentr<span class="sc">::</span><span class="fu">get_sentences</span>(hotel_1<span class="sc">$</span>review) <span class="sc">%&gt;%</span></span>
<span id="cb46-3"><a href="polarity-scoring.html#cb46-3" tabindex="-1"></a>  sentimentr<span class="sc">::</span><span class="fu">sentiment</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb46-4"><a href="polarity-scoring.html#cb46-4" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">.by =</span> element_id, <span class="at">sentimentr_polarity =</span> <span class="fu">mean</span>(sentiment))</span>
<span id="cb46-5"><a href="polarity-scoring.html#cb46-5" tabindex="-1"></a></span>
<span id="cb46-6"><a href="polarity-scoring.html#cb46-6" tabindex="-1"></a>hotel_2 <span class="ot">&lt;-</span></span>
<span id="cb46-7"><a href="polarity-scoring.html#cb46-7" tabindex="-1"></a>  hotel_1 <span class="sc">%&gt;%</span></span>
<span id="cb46-8"><a href="polarity-scoring.html#cb46-8" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">element_id =</span> <span class="fu">row_number</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb46-9"><a href="polarity-scoring.html#cb46-9" tabindex="-1"></a>  <span class="fu">inner_join</span>(hotel_sentimentr, <span class="at">by =</span> <span class="fu">join_by</span>(element_id)) <span class="sc">%&gt;%</span></span>
<span id="cb46-10"><a href="polarity-scoring.html#cb46-10" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>element_id)</span></code></pre></div>
<p>Let’s see a few examples where <strong>sentimentr</strong> differed from <strong>tidytext</strong>. Looks like <strong>bing</strong> did a better job on the first one, but <strong>sentimentr</strong> was better on the next two.</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="polarity-scoring.html#cb47-1" tabindex="-1"></a>hotel_2 <span class="sc">%&gt;%</span></span>
<span id="cb47-2"><a href="polarity-scoring.html#cb47-2" tabindex="-1"></a>  <span class="fu">filter</span>((bing_polarity <span class="sc">&gt;</span> <span class="fl">0.2</span> <span class="sc">&amp;</span> sentimentr_polarity <span class="sc">&lt;</span> <span class="sc">-</span><span class="fl">0.2</span>) <span class="sc">|</span> </span>
<span id="cb47-3"><a href="polarity-scoring.html#cb47-3" tabindex="-1"></a>           (bing_polarity <span class="sc">&lt;</span> <span class="sc">-</span><span class="fl">0.2</span> <span class="sc">&amp;</span> sentimentr_polarity <span class="sc">&gt;</span> <span class="fl">0.2</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb47-4"><a href="polarity-scoring.html#cb47-4" tabindex="-1"></a>  <span class="fu">select</span>(review, bing_polarity, sentimentr_polarity) <span class="sc">%&gt;%</span></span>
<span id="cb47-5"><a href="polarity-scoring.html#cb47-5" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">3</span>) <span class="sc">%&gt;%</span></span>
<span id="cb47-6"><a href="polarity-scoring.html#cb47-6" tabindex="-1"></a>  flextable<span class="sc">::</span><span class="fu">flextable</span>() <span class="sc">%&gt;%</span></span>
<span id="cb47-7"><a href="polarity-scoring.html#cb47-7" tabindex="-1"></a>  flextable<span class="sc">::</span><span class="fu">autofit</span>()</span></code></pre></div>
<div class="tabwid tabwid_left"><style>.cl-9fdafe30{}.cl-9fd381b4{font-family:'Arial';font-size:10pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-9fd381c8{font-family:'Arial';font-size:10pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-9fd72e2c{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-9fd72e36{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-9fd73cf0{width:56.161in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9fd73cfa{width:1.157in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9fd73cfb{width:1.574in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9fd73d04{width:56.161in;background-color:transparent;vertical-align: middle;border-bottom: 0.75pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9fd73d05{width:1.157in;background-color:transparent;vertical-align: middle;border-bottom: 0.75pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9fd73d0e{width:1.574in;background-color:transparent;vertical-align: middle;border-bottom: 0.75pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9fd73d0f{width:56.161in;background-color:transparent;vertical-align: middle;border-bottom: 0.75pt solid rgba(102, 102, 102, 1.00);border-top: 0.75pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9fd73d18{width:1.157in;background-color:transparent;vertical-align: middle;border-bottom: 0.75pt solid rgba(102, 102, 102, 1.00);border-top: 0.75pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9fd73d19{width:1.574in;background-color:transparent;vertical-align: middle;border-bottom: 0.75pt solid rgba(102, 102, 102, 1.00);border-top: 0.75pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9fd73d22{width:56.161in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0.75pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9fd73d2c{width:1.157in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0.75pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9fd73d2d{width:1.574in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0.75pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing='true' class='cl-9fdafe30'><thead><tr style="overflow-wrap:break-word;"><th class="cl-9fd73cf0"><p class="cl-9fd72e2c"><span class="cl-9fd381b4">review</span></p></th><th class="cl-9fd73cfa"><p class="cl-9fd72e36"><span class="cl-9fd381b4">bing_polarity</span></p></th><th class="cl-9fd73cfb"><p class="cl-9fd72e36"><span class="cl-9fd381b4">sentimentr_polarity</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-9fd73d04"><p class="cl-9fd72e2c"><span class="cl-9fd381c8">We were locked out of our room twice in a 3 day stay due to the Savoy not being able to track our reservation - the excuses included that we were responsible until they finally admitted their system is fouled up</span></p></td><td class="cl-9fd73d05"><p class="cl-9fd72e36"><span class="cl-9fd381c8">-0.3162278</span></p></td><td class="cl-9fd73d0e"><p class="cl-9fd72e36"><span class="cl-9fd381c8">0.2161730</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-9fd73d0f"><p class="cl-9fd72e2c"><span class="cl-9fd381c8">For many years I had fantasised about staying at The Dorchester so when the opportunity arose I jumped at it. Needless to say, as one of the great British institutions, it's a lovely hotel however it is not fabulous. It has two lovely dining areas /restaurants albeit pricey. I was extremely disappointed by the rooms! The corridors were creaky and narrow and the rooms pokey. There's no doubt it was tasteful decorated, however I was noisy -if the internal door wasn't shut and space was tight with a capital T. The double bed was very compact for 2, there was hardly any space to walk around it! Very claustrophobic! On a positive note the bathroom was spacious with delicious toiletries and good high pressure hot showers - and it you are a lover of hotel slippers- this one was good quality. All in all - charming but not worth the price or reputation- that is in the standard rooms. A word of advise- don't take your car!</span></p></td><td class="cl-9fd73d18"><p class="cl-9fd72e36"><span class="cl-9fd381c8">0.4670994</span></p></td><td class="cl-9fd73d19"><p class="cl-9fd72e36"><span class="cl-9fd381c8">-0.2377933</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-9fd73d22"><p class="cl-9fd72e2c"><span class="cl-9fd381c8">Wonderful. Far better than The Ritz (slow and stiff) and Harvey Nichols (noisy and showy). The service is unsurpassable. Extensive range of teas. Enough food to make dinner unnecessary. Relaxed and unhurried atmosphere. I'm already looking forward to coming back.</span></p></td><td class="cl-9fd73d2c"><p class="cl-9fd72e36"><span class="cl-9fd381c8">-0.4743416</span></p></td><td class="cl-9fd73d2d"><p class="cl-9fd72e36"><span class="cl-9fd381c8">0.2145884</span></p></td></tr></tbody></table></div>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="3">
<li id="fn3"><p>There is a third package called <strong>qdap</strong>, but the <strong>sentimentr</strong> <a href="https://cran.r-project.org/web/packages/sentimentr/readme/README.html">Read Me</a> explains <strong>sentimentr</strong> is an improved version that better balances accuracy and speed.<a href="polarity-scoring.html#fnref3" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="subjectivity-lexicons.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="statistical-test.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="assets/gitbook-2.6.7/js/app.min.js"></script>
<script src="assets/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="assets/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection",
"scroll_highlight": true
},
"toolbar": {
"position": "static"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
